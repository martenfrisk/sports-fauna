{"ast":null,"code":"import { serialize, parse } from 'cookie';\nconst TOKEN_NAME = 'faunaToken';\nconst MAX_AGE = 60 * 60 * 8;\nexport function setAuthCookie(res, token) {\n  const cookie = serialize(TOKEN_NAME, token, {\n    httpOnly: true,\n    maxAge: MAX_AGE,\n    path: '/',\n    sameSite: 'lax',\n    secure: false\n  });\n  res.setHeader('Set-Cookie', cookie);\n}\nexport function removeAuthCookie(res) {\n  const cookie = serialize(TOKEN_NAME, '', {\n    maxAge: -1,\n    path: '/'\n  });\n  res.setHeader('Set-Cookie', cookie);\n}\nexport function getAuthCookie(req) {\n  if (req.cookies) return req.cookies[TOKEN_NAME];\n  const cookies = parse(req.headers.cookie || '');\n  return cookies[TOKEN_NAME];\n}","map":{"version":3,"sources":["/Users/marten.frisk/nextfauna/utils/auth-cookies.js"],"names":["serialize","parse","TOKEN_NAME","MAX_AGE","setAuthCookie","res","token","cookie","httpOnly","maxAge","path","sameSite","secure","setHeader","removeAuthCookie","getAuthCookie","req","cookies","headers"],"mappings":"AAAA,SAASA,SAAT,EAAoBC,KAApB,QAAiC,QAAjC;AAEA,MAAMC,UAAU,GAAG,YAAnB;AACA,MAAMC,OAAO,GAAG,KAAK,EAAL,GAAU,CAA1B;AAEA,OAAO,SAASC,aAAT,CAAuBC,GAAvB,EAA4BC,KAA5B,EAAmC;AACzC,QAAMC,MAAM,GAAGP,SAAS,CAACE,UAAD,EAAaI,KAAb,EAAoB;AAC3CE,IAAAA,QAAQ,EAAE,IADiC;AAE3CC,IAAAA,MAAM,EAAEN,OAFmC;AAG3CO,IAAAA,IAAI,EAAE,GAHqC;AAI3CC,IAAAA,QAAQ,EAAE,KAJiC;AAK3CC,IAAAA,MAAM;AALqC,GAApB,CAAxB;AAQAP,EAAAA,GAAG,CAACQ,SAAJ,CAAc,YAAd,EAA4BN,MAA5B;AACA;AAED,OAAO,SAASO,gBAAT,CAA0BT,GAA1B,EAA+B;AACrC,QAAME,MAAM,GAAGP,SAAS,CAACE,UAAD,EAAa,EAAb,EAAiB;AACxCO,IAAAA,MAAM,EAAE,CAAC,CAD+B;AAExCC,IAAAA,IAAI,EAAE;AAFkC,GAAjB,CAAxB;AAKAL,EAAAA,GAAG,CAACQ,SAAJ,CAAc,YAAd,EAA4BN,MAA5B;AACA;AAED,OAAO,SAASQ,aAAT,CAAuBC,GAAvB,EAA4B;AAClC,MAAIA,GAAG,CAACC,OAAR,EAAiB,OAAOD,GAAG,CAACC,OAAJ,CAAYf,UAAZ,CAAP;AAEjB,QAAMe,OAAO,GAAGhB,KAAK,CAACe,GAAG,CAACE,OAAJ,CAAYX,MAAZ,IAAsB,EAAvB,CAArB;AACA,SAAOU,OAAO,CAACf,UAAD,CAAd;AACA","sourcesContent":["import { serialize, parse } from 'cookie'\n\nconst TOKEN_NAME = 'faunaToken'\nconst MAX_AGE = 60 * 60 * 8\n\nexport function setAuthCookie(res, token) {\n\tconst cookie = serialize(TOKEN_NAME, token, {\n\t\thttpOnly: true,\n\t\tmaxAge: MAX_AGE,\n\t\tpath: '/',\n\t\tsameSite: 'lax',\n\t\tsecure: process.env.NODE_ENV === 'production'\n\t})\n  \n\tres.setHeader('Set-Cookie', cookie)\n}\n\nexport function removeAuthCookie(res) {\n\tconst cookie = serialize(TOKEN_NAME, '', {\n\t\tmaxAge: -1,\n\t\tpath: '/'\n\t})\n\n\tres.setHeader('Set-Cookie', cookie)\n}\n\nexport function getAuthCookie(req) {\n\tif (req.cookies) return req.cookies[TOKEN_NAME]\n\n\tconst cookies = parse(req.headers.cookie || '')\n\treturn cookies[TOKEN_NAME]\n}"]},"metadata":{},"sourceType":"module"}